{
    "variables": {
        "printnanny_release_channel": "main"

    },
    "builders": [{
        "type": "arm",
        "file_urls": ["https://downloads.raspberrypi.org/raspios_arm64/images/raspios_arm64-2021-05-28/2021-05-07-raspios-buster-arm64.zip"],
        "file_checksum_url": "https://downloads.raspberrypi.org/raspios_arm64/images/raspios_arm64-2021-05-28/2021-05-07-raspios-buster-arm64.zip.sha256",
        "file_checksum_type": "sha256",
        "file_target_extension": "zip",
        "image_build_method": "reuse",
        "image_path": "2021-05-07-raspios-buster-arm64.img",
        "image_size": "2G",
        "image_type": "dos",
        "image_partitions": [
            {
            "name": "boot",
            "type": "c",
            "start_sector": "8192",
            "filesystem": "vfat",
            "size": "256M",
            "mountpoint": "/boot"
            },
            {
            "name": "root",
            "type": "83",
            "start_sector": "532480",
            "filesystem": "ext4",
            "size": "0",
            "mountpoint": "/"
            }
        ],
        "image_mount_path": "/tmp/rpi_chroot",
        "image_chroot_env": ["PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/bin:/sbin"],
        "qemu_binary_source_path": "/usr/bin/qemu-arm-static",
        "qemu_binary_destination_path": "/usr/bin/qemu-arm-static"
    }],  
    "provisioners": [
      {
        "type": "shell",
        "inline": [
            "touch /boot/ssh"
        ]
      },
      {
        "type": "ansible",
        "playbook_file": "./playbooks/printnanny.yml",
        "galaxy_file": "./playbooks/requirements.yml",
        "extra_arguments": [
            "--extra-vars",
            "\"printnanny_release_channel={{ user `printnanny_release_channel`}}\""
          ]      }
    ],
    "post-processors": [
        {
          "type": "manifest",
          "output": "manifest.json",
          "strip_path": true
        }
      ]
  }